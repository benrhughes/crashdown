#!/usr/local/bin/node 
var fs = require('fs')
var prompt = require('prompt')
var path = require('path');
var mkdirp = require('mkdirp');

prompt.message = 'Page';
prompt.start();

prompt.get(['author','title', 'folder', 'summary', 'tags'], function(err, data){
	data.date = new Date();

	if(data.tags && !Array.isArray(data.tags))
		data.tags = [data.tags];

	
	var dir = path.join(__dirname, 'pages', data.folder);
	var file = path.join(dir,  data.title.replace(/\s/g,'-').toLowerCase());

	mkdirp(dir, function (){
		fs.writeFile(file + '.json', JSON.stringify(data, null, '\t'), function(err){
			fs.writeFile(file + '.mkd', '');
		});
	});
});

